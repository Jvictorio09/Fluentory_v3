{% extends 'teacher/base.html' %}

{% block title %}Live Sessions{% endblock %}
{% block page_title %}Live Sessions{% endblock %}

{% block content %}
<div class="flex items-center justify-between mb-6">
    <div>
        <h2 class="text-2xl font-bold mb-2 text-black">Live Sessions</h2>
        <p class="text-gray-700">Manage your live class sessions</p>
    </div>
</div>

<!-- Filters -->
<div class="bg-[#ffffff]/60 backdrop-blur-sm border border-teal-soft/10 rounded-xl p-4 mb-6">
    <form method="GET" class="flex flex-wrap gap-4 items-end">
        <div class="flex-1 min-w-[200px]">
            <label class="block text-sm font-semibold text-gray-700 mb-2">Course</label>
            <select name="course" class="w-full bg-[#ffffff]/40 border border-teal-soft/20 rounded-lg px-4 py-2 focus:outline-none focus:border-teal-soft/50 text-gray-800">
                <option value="">All Courses</option>
                {% for course in courses %}
                <option value="{{ course.id }}" {% if course_filter == course.id|stringformat:"s" %}selected{% endif %}>{{ course.name }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="flex-1 min-w-[200px]">
            <label class="block text-sm font-semibold text-gray-700 mb-2">Status</label>
            <select name="status" class="w-full bg-[#ffffff]/40 border border-teal-soft/20 rounded-lg px-4 py-2 focus:outline-none focus:border-teal-soft/50 text-gray-800">
                <option value="all" {% if status_filter == 'all' %}selected{% endif %}>All Status</option>
                <option value="scheduled" {% if status_filter == 'scheduled' %}selected{% endif %}>Scheduled</option>
                <option value="in_progress" {% if status_filter == 'in_progress' %}selected{% endif %}>In Progress</option>
                <option value="completed" {% if status_filter == 'completed' %}selected{% endif %}>Completed</option>
                <option value="cancelled" {% if status_filter == 'cancelled' %}selected{% endif %}>Cancelled</option>
            </select>
        </div>
        <div>
            <button type="submit" class="px-6 py-2 bg-teal-soft text-[#ffffff] rounded-lg font-medium hover:bg-teal-soft/90 transition-all text-gray-800">
                <i class="fas fa-filter mr-2"></i> Filter
            </button>
        </div>
    </form>
</div>

<!-- Sessions List -->
<div class="space-y-4">
    {% for session in sessions %}
    <div class="bg-[#ffffff]/60 backdrop-blur-sm border border-teal-soft/10 rounded-xl p-6 hover:border-teal-soft/30 transition-all">
        <div class="flex items-start justify-between">
            <div class="flex-1">
                <div class="flex items-center gap-3 mb-2">
                    <h3 class="text-xl font-bold text-gray-800">{{ session.title }}</h3>
                    <span class="px-3 py-1 rounded-full text-xs font-semibold
                        {% if session.status == 'scheduled' %}bg-green-500/20 text-gray-700 border border-green-500/30
                        {% elif session.status == 'in_progress' %}bg-blue-500/20 text-blue-400 border border-blue-500/30
                        {% elif session.status == 'completed' %}bg-gray-500/20 text-gray-700 border border-gray-500/30
                        {% else %}bg-red-500/20 text-red-400 border border-red-500/30{% endif %}">
                        {{ session.get_status_display }}
                    </span>
                </div>
                <p class="text-sm text-gray-700 mb-3">{{ session.course.name }}</p>
                <div class="flex flex-wrap gap-4 text-sm text-gray-700">
                    <span><i class="fas fa-calendar mr-1"></i> {{ session.scheduled_at|date:"M d, Y" }}</span>
                    <span><i class="fas fa-clock mr-1"></i> {{ session.scheduled_at|time:"g:i A" }}</span>
                    <span><i class="fas fa-hourglass-half mr-1"></i> {{ session.duration_minutes }} min</span>
                    <span><i class="fas fa-users mr-1"></i> {{ session.get_bookings_count }} bookings</span>
                    {% if session.capacity %}<span><i class="fas fa-user-lock mr-1"></i> Capacity: {{ session.capacity }}</span>{% endif %}
                </div>
            </div>
            <div class="flex gap-2 ml-4">
                <a href="{% url 'teacher_live_session_detail' session.id %}" class="px-4 py-2 bg-teal-soft/10 border border-teal-soft/30 rounded-lg font-medium hover:bg-teal-soft/20 transition-all text-gray-800">
                    View
                </a>
                {% if session.status == 'scheduled' %}
                <a href="{% url 'teacher_live_session_edit' session.id %}" class="px-4 py-2 bg-blue-soft/10 border border-blue-soft/30 rounded-lg font-medium hover:bg-blue-soft/20 transition-all text-gray-800">
                    Edit
                </a>
                {% endif %}
            </div>
        </div>
    </div>
    {% empty %}
    <div class="text-center py-16 bg-[#ffffff]/60 backdrop-blur-sm border border-teal-soft/10 rounded-xl">
        <i class="fas fa-calendar-times text-6xl text-gray-600 mb-4"></i>
        <p class="text-gray-700 text-lg mb-6">No live sessions found</p>
        {% if courses %}
        <p class="text-sm text-gray-600 mb-4">Create a live session from one of your courses</p>
        {% else %}
        <p class="text-sm text-gray-600 mb-4">Create a course first to add live sessions</p>
        <a href="{% url 'teacher_add_course' %}" class="inline-block px-6 py-3 bg-teal-soft text-[#ffffff] rounded-full font-bold hover:bg-teal-soft/90 transition-all text-gray-800">
            Create Course
        </a>
        {% endif %}
    </div>
    {% endfor %}
</div>
{% endblock %}

