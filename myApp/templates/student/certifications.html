{% extends 'base.html' %}
{% load static %}

{% block title %}My Certifications - Swedish Wealth Institute{% endblock %}

{% block content %}
<div class="space-y-8">
    <!-- Header -->
    <div class="flex items-center justify-between">
        <div>
            <a href="{% url 'student_dashboard' %}" class="text-teal-700 hover:text-teal-800 mb-2 inline-flex items-center gap-2 text-sm">
                <i class="fas fa-arrow-left"></i> Back to Dashboard
            </a>
            <h1 class="text-4xl font-bold mb-2">My Certifications</h1>
            <p class="text-gray-700">View and manage your earned certifications</p>
        </div>
    </div>

    <!-- Trophy Achievements Section -->
    <div class="bg-[#ffffff]/60 backdrop-blur-sm border border-teal-soft/10 rounded-2xl p-8 mb-8">
        <div class="flex items-center justify-between mb-6">
            <div>
                <h2 class="text-2xl font-bold mb-2 text-black">Achievement Trophies</h2>
                <p class="text-gray-700 text-sm">Unlock trophies by completing courses and earning certifications</p>
            </div>
            <div class="text-right">
                <div class="text-3xl font-bold text-black">{{ certifications|length }}</div>
                <div class="text-xs text-gray-500">Certifications Earned</div>
            </div>
        </div>
        
        <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
            <!-- Bronze Trophy -->
            <div class="trophy-card {% if certifications|length >= 1 %}unlocked{% else %}locked{% endif %}" data-tier="bronze">
                <div class="trophy-icon">
                    <svg viewBox="0 0 100 120" class="w-20 h-20 mx-auto">
                        <defs>
                            <linearGradient id="bronzeGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" style="stop-color:#cd7f32;stop-opacity:1" />
                                <stop offset="50%" style="stop-color:#b87333;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#8b5a2b;stop-opacity:1" />
                            </linearGradient>
                        </defs>
                        <path d="M50 10 L60 50 L50 60 L40 50 Z" fill="url(#bronzeGrad)" stroke="#cd7f32" stroke-width="2"/>
                        <rect x="45" y="50" width="10" height="30" fill="url(#bronzeGrad)"/>
                        <rect x="40" y="80" width="20" height="8" rx="2" fill="url(#bronzeGrad)"/>
                        <rect x="35" y="88" width="30" height="25" rx="3" fill="url(#bronzeGrad)"/>
                    </svg>
                </div>
                <h3 class="text-sm font-semibold text-gray-700 mt-2">First Steps</h3>
                <p class="text-xs text-gray-500">1 Certification</p>
            </div>
            
            <!-- Silver Trophy -->
            <div class="trophy-card {% if certifications|length >= 3 %}unlocked{% else %}locked{% endif %}" data-tier="silver">
                <div class="trophy-icon">
                    <svg viewBox="0 0 100 120" class="w-20 h-20 mx-auto">
                        <defs>
                            <linearGradient id="silverGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" style="stop-color:#c0c0c0;stop-opacity:1" />
                                <stop offset="50%" style="stop-color:#a8a8a8;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#808080;stop-opacity:1" />
                            </linearGradient>
                        </defs>
                        <path d="M50 10 L60 50 L50 60 L40 50 Z" fill="url(#silverGrad)" stroke="#c0c0c0" stroke-width="2"/>
                        <rect x="45" y="50" width="10" height="30" fill="url(#silverGrad)"/>
                        <rect x="40" y="80" width="20" height="8" rx="2" fill="url(#silverGrad)"/>
                        <rect x="35" y="88" width="30" height="25" rx="3" fill="url(#silverGrad)"/>
                    </svg>
                </div>
                <h3 class="text-sm font-semibold text-gray-700 mt-2">Rising Star</h3>
                <p class="text-xs text-gray-500">3 Certifications</p>
            </div>
            
            <!-- Gold Trophy -->
            <div class="trophy-card {% if certifications|length >= 5 %}unlocked{% else %}locked{% endif %}" data-tier="gold">
                <div class="trophy-icon">
                    <svg viewBox="0 0 100 120" class="w-20 h-20 mx-auto">
                        <defs>
                            <linearGradient id="goldGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" style="stop-color:#ffd700;stop-opacity:1" />
                                <stop offset="50%" style="stop-color:#ffed4e;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#daa520;stop-opacity:1" />
                            </linearGradient>
                        </defs>
                        <path d="M50 10 L60 50 L50 60 L40 50 Z" fill="url(#goldGrad)" stroke="#ffd700" stroke-width="2"/>
                        <rect x="45" y="50" width="10" height="30" fill="url(#goldGrad)"/>
                        <rect x="40" y="80" width="20" height="8" rx="2" fill="url(#goldGrad)"/>
                        <rect x="35" y="88" width="30" height="25" rx="3" fill="url(#goldGrad)"/>
                    </svg>
                </div>
                <h3 class="text-sm font-semibold text-gray-700 mt-2">Expert</h3>
                <p class="text-xs text-gray-500">5 Certifications</p>
            </div>
            
            <!-- Platinum Trophy -->
            <div class="trophy-card {% if certifications|length >= 8 %}unlocked{% else %}locked{% endif %}" data-tier="platinum">
                <div class="trophy-icon">
                    <svg viewBox="0 0 100 120" class="w-20 h-20 mx-auto">
                        <defs>
                            <linearGradient id="platinumGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" style="stop-color:#e5e4e2;stop-opacity:1" />
                                <stop offset="50%" style="stop-color:#d4d4d4;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#b8b8b8;stop-opacity:1" />
                            </linearGradient>
                        </defs>
                        <path d="M50 10 L60 50 L50 60 L40 50 Z" fill="url(#platinumGrad)" stroke="#e5e4e2" stroke-width="2"/>
                        <rect x="45" y="50" width="10" height="30" fill="url(#platinumGrad)"/>
                        <rect x="40" y="80" width="20" height="8" rx="2" fill="url(#platinumGrad)"/>
                        <rect x="35" y="88" width="30" height="25" rx="3" fill="url(#platinumGrad)"/>
                    </svg>
                </div>
                <h3 class="text-sm font-semibold text-gray-700 mt-2">Master</h3>
                <p class="text-xs text-gray-500">8 Certifications</p>
            </div>
            
            <!-- Diamond Trophy -->
            <div class="trophy-card {% if certifications|length >= 12 %}unlocked{% else %}locked{% endif %}" data-tier="diamond">
                <div class="trophy-icon">
                    <svg viewBox="0 0 100 120" class="w-20 h-20 mx-auto">
                        <defs>
                            <linearGradient id="diamondGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" style="stop-color:#b9f2ff;stop-opacity:1" />
                                <stop offset="50%" style="stop-color:#7dd3fc;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#0ea5e9;stop-opacity:1" />
                            </linearGradient>
                        </defs>
                        <path d="M50 10 L60 50 L50 60 L40 50 Z" fill="url(#diamondGrad)" stroke="#b9f2ff" stroke-width="2"/>
                        <rect x="45" y="50" width="10" height="30" fill="url(#diamondGrad)"/>
                        <rect x="40" y="80" width="20" height="8" rx="2" fill="url(#diamondGrad)"/>
                        <rect x="35" y="88" width="30" height="25" rx="3" fill="url(#diamondGrad)"/>
                    </svg>
                </div>
                <h3 class="text-sm font-semibold text-gray-700 mt-2">Legend</h3>
                <p class="text-xs text-gray-500">12 Certifications</p>
            </div>
            
            <!-- Ultimate Trophy -->
            <div class="trophy-card {% if certifications|length >= 20 %}unlocked{% else %}locked{% endif %}" data-tier="ultimate">
                <div class="trophy-icon">
                    <svg viewBox="0 0 100 120" class="w-20 h-20 mx-auto">
                        <defs>
                            <linearGradient id="ultimateGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" style="stop-color:#9333ea;stop-opacity:1" />
                                <stop offset="50%" style="stop-color:#a855f7;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#7e22ce;stop-opacity:1" />
                            </linearGradient>
                        </defs>
                        <path d="M50 10 L60 50 L50 60 L40 50 Z" fill="url(#ultimateGrad)" stroke="#9333ea" stroke-width="2"/>
                        <rect x="45" y="50" width="10" height="30" fill="url(#ultimateGrad)"/>
                        <rect x="40" y="80" width="20" height="8" rx="2" fill="url(#ultimateGrad)"/>
                        <rect x="35" y="88" width="30" height="25" rx="3" fill="url(#ultimateGrad)"/>
                        <circle cx="50" cy="30" r="8" fill="#ffd700"/>
                    </svg>
                </div>
                <h3 class="text-sm font-semibold text-gray-700 mt-2">Ultimate</h3>
                <p class="text-xs text-gray-500">20 Certifications</p>
            </div>
        </div>
    </div>
    
    <style>
        .trophy-card {
            background: rgba(10, 14, 39, 0.4);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(107, 114, 128, 0.2);
            border-radius: 0.75rem;
            padding: 1rem;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .trophy-card.locked {
            opacity: 0.5;
            filter: grayscale(100%);
        }
        
        .trophy-card.unlocked {
            border-color: rgba(0, 240, 255, 0.3);
            background: linear-gradient(to bottom, rgba(10, 14, 39, 0.6), rgba(10, 14, 39, 0.4));
            box-shadow: 0 4px 20px rgba(0, 240, 255, 0.1);
        }
        
        .trophy-card.unlocked:hover {
            border-color: rgba(0, 240, 255, 0.5);
            box-shadow: 0 8px 30px rgba(0, 240, 255, 0.2);
            transform: translateY(-4px) scale(1.05);
        }
        
        .trophy-card.locked:hover {
            opacity: 0.7;
        }
        
        .trophy-icon {
            margin-bottom: 0.5rem;
        }
        
        .trophy-card.unlocked .trophy-icon svg {
            filter: drop-shadow(0 0 10px rgba(0, 240, 255, 0.3));
        }
        
        .trophy-card[data-tier="bronze"].unlocked .trophy-icon svg {
            filter: drop-shadow(0 0 8px rgba(205, 127, 50, 0.4));
        }
        
        .trophy-card[data-tier="silver"].unlocked .trophy-icon svg {
            filter: drop-shadow(0 0 8px rgba(192, 192, 192, 0.4));
        }
        
        .trophy-card[data-tier="gold"].unlocked .trophy-icon svg {
            filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.5));
        }
        
        .trophy-card[data-tier="platinum"].unlocked .trophy-icon svg {
            filter: drop-shadow(0 0 10px rgba(229, 228, 226, 0.4));
        }
        
        .trophy-card[data-tier="diamond"].unlocked .trophy-icon svg {
            filter: drop-shadow(0 0 12px rgba(185, 242, 255, 0.6));
        }
        
        .trophy-card[data-tier="ultimate"].unlocked .trophy-icon svg {
            filter: drop-shadow(0 0 15px rgba(147, 51, 234, 0.6)) drop-shadow(0 0 8px rgba(255, 215, 0, 0.4));
        }
    </style>

    <!-- Certifications List -->
    {% if certifications %}
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        {% for cert in certifications %}
        <div class="bg-[#ffffff]/60 backdrop-blur-sm border border-teal-soft/10 rounded-xl p-6 hover:border-teal-soft/30 transition-all">
            <div class="flex items-start justify-between mb-4">
                <div class="flex-1">
                    <div class="flex items-center gap-3 mb-3">
                        <div class="w-12 h-12 rounded-lg bg-gradient-to-br from-yellow-500/20 to-yellow-600/20 border border-yellow-500/30 flex items-center justify-center">
                            <i class="fas fa-certificate text-black-400 text-2xl"></i>
                        </div>
                        <div>
                            <h3 class="text-xl font-bold text-black">{{ cert.course.name }}</h3>
                            <p class="text-sm text-gray-700">{{ cert.course.course_type|title }} Course</p>
                        </div>
                    </div>
                    
                    <div class="space-y-2 mb-4">
                        <div class="flex items-center justify-between">
                            <span class="text-sm text-gray-700">Status</span>
                            <span class="px-3 py-1 rounded-full text-xs font-semibold text-gray-700
                                {% if cert.status == 'passed' %}bg-yellow-500/20 text-yellow-300 border border-yellow-500/30
                                {% elif cert.status == 'failed' %}bg-red-500/20 text-red-400 border border-red-500/30
                                {% elif cert.status == 'eligible' %}bg-teal-soft/20 text-black border border-teal-soft/30
                                {% else %}bg-gray-500/20 text-gray-700 border border-gray-500/30{% endif %}">
                                {{ cert.get_status_display }}
                            </span>
                        </div>
                        {% if cert.issued_at %}
                        <div class="flex items-center justify-between">
                            <span class="text-sm text-gray-700">Issued Date</span>
                            <span class="text-sm font-medium text-black">{{ cert.issued_at|date:"F d, Y" }}</span>
                        </div>
                        {% endif %}
                        {% if cert.accredible_certificate_id %}
                        <div class="flex items-center justify-between">
                            <span class="text-sm text-gray-700">Certificate ID</span>
                            <span class="text-xs font-mono text-gray-500">{{ cert.accredible_certificate_id|truncatechars:20 }}</span>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
            
            {% if cert.accredible_certificate_url %}
            <a href="{{ cert.accredible_certificate_url }}" target="_blank" class="block w-full px-4 py-3 bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-500/90 hover:to-yellow-600/90 text-white font-semibold text-gray-700 rounded-lg transition-all text-center">
                <i class="fas fa-download mr-2"></i>Download Certificate
            </a>
            {% elif cert.status == 'passed' %}
            <a href="{% url 'view_certificate' cert.course.slug %}" target="_blank" class="block w-full px-4 py-3 bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-500/90 hover:to-yellow-600/90 text-white font-semibold text-gray-700 rounded-lg transition-all text-center">
                <i class="fas fa-download mr-2"></i>Download Certificate
            </a>
            {% elif cert.status == 'eligible' %}
            <a href="{% url 'student_course_progress' cert.course.slug %}" class="block w-full px-4 py-3 bg-gradient-to-r from-teal-soft to-blue-soft hover:from-teal-soft/90 hover:to-blue-soft/90 text-[#ffffff] font-semibold text-gray-700 rounded-lg transition-all text-center">
                Take Final Exam
            </a>
            {% endif %}
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="bg-[#ffffff]/60 backdrop-blur-sm border border-teal-soft/10 rounded-xl p-12 text-center">
        <i class="fas fa-certificate text-6xl text-gray-600 mb-4"></i>
        <h3 class="text-xl font-semibold text-gray-700 mb-2">No Certifications Yet</h3>
        <p class="text-gray-700 mb-6">Complete courses and pass exams to earn certifications</p>
        <a href="{% url 'student_dashboard' %}" class="inline-block px-6 py-3 bg-gradient-to-r from-teal-soft to-blue-soft hover:from-teal-soft/90 hover:to-blue-soft/90 text-[#ffffff] font-semibold text-gray-700 rounded-xl transition-all">
            View My Courses
        </a>
    </div>
    {% endif %}

    <!-- Eligible Courses -->
    {% if eligible_courses %}
    <div class="mt-8">
        <h2 class="text-2xl font-bold mb-4">Eligible for Certification</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            {% for course in eligible_courses %}
            <div class="bg-[#ffffff]/60 backdrop-blur-sm border border-teal-soft/10 rounded-xl p-6">
                <h3 class="text-lg font-bold mb-2">{{ course.name }}</h3>
                <p class="text-sm text-gray-700 mb-4">You've completed all lessons. Take the final exam to earn your certification!</p>
                <a href="{% url 'student_course_progress' course.slug %}" class="inline-block px-4 py-2 bg-gradient-to-r from-teal-soft to-blue-soft hover:from-teal-soft/90 hover:to-blue-soft/90 text-[#ffffff] font-semibold text-gray-700 rounded-lg transition-all">
                    View Course & Exam
                </a>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}



